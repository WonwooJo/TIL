# eps(epsilon)? Æ¯Á¤?? 1?? ?????Í·Îº??? ?????? ?Å¸?
# eps ??À§ ???? ?????Í°? minPts?? ?Ì»? ??À¸?? Å¬?????Í·? ?Î½?
# 
# ex) Á¡ p?? ??À»??, Á¡ p?Îº???  eps ?Ì³??? ?Ù¸? Á¡????(Á¡ p?? ???Ôµ?) minPts?? ?Ì»? ?Ö´Ù¸?,
# ?? ????À» ?Ï³??? Å¬?????Í·? ????


#kmeans?? ?Ì¿??? Å¬?????Í¸?(snsdata)
#1?? ?????? ?Ð¼? ?Á·?Á§Æ® ????(Á¶?? : 4?? Á¤??) -> ??Ç¥
#??Ãµ?Ã½???, ?Ã°?È­(?Ð¼?), ??È¸ ?Ì½?, ?Ç¸?(???? ??Ç°), ?í°´ ?Ð·? ????
#data.go.kr, uci.edu, ...Å©?Ñ¸?

#2?? ?Ø½?Æ® ?Ð·? ?Á·?Á§Æ® ???? ??Á¤(10?? ??~11?? ??)


teens<-read.csv("snsdata.csv")
str(teens)

table(teens$gender) #table?Ô¼????? NA??Àº ?????? ???Ö·? ???????? ?Ê°? Á¦??

table(teens$gender,useNA = "ifany") #NA???? ???Ö·? ????

table(teens$gradyear) #Á¹??????

#1. ???À¹?Á¦
#gender?? ?Ù¸? ??À¸?? ??Ã¼, na ??À» ???? ?Ð»??? ???? À¯????(?Å¸?) ?Ð»? 10?? ?Ë»? -> ???? ?Ç´? = Å¬?????Í¸?

#table(teens$age)
summary(teens$age) #????????(describe)


#?????? ?????Í¿? ???? ????Ä¡?? ?????? ???Ö·? ????????
str(teens)

teens$age<-ifelse(teens$age>=13 & teens$age<20, teens$age, NA) #stats or boxplot ????
summary(teens$age)

teens$female<-ifelse(teens$gender=="F" & !is.na(teens$gender), 1, 0) #F?Ì¸é¼­ NA?? ?Æ´Ï¸? 1, ?×·??? ?Ê¸? ????(0)

teens$no_gender<-ifelse(is.na(teens$gender),1,0) #gender?? NA?Ì¸? 1 ?Æ´Ï¸? 0

table(teens$gender, useNA = "ifany")

teens$female<-ifelse(teens$gender=="F" & !is.na(teens$gender), 1, 0) #F?Ì¸é¼­ NA?? ?Æ´Ï¸? 1, ?×·??? ?Ê¸? ????(0)
table(teens$female, useNA="ifany")

teens$no_gender<-ifelse(is.na(teens$gender),1,0) #gender?? NA?Ì¸? 1 ?Æ´Ï¸? 0
table(teens$no_gender, useNA="ifany")


#???? : F OR M

mean(teens$age)
mean(teens$age, na.rm=TRUE)

#Á¹?????? Á¤?? -> ???? À¯??

#????1.
#Á¹???????? ???? ?????? ????
#Á¹?????? Á¶??, ?? Á¹???????? ???? ????
library(dplyr)

# aggregate(data, y(????)~x(Á¹??????), ?????Ô¼?(????), na.rm=TRUE)
# x?? ????À¸?? y?? ???? ?????Ô¼??? ????

aggregate(data=teens,age~gradyear, mean, na.rm=TRUE)

#???Ì°? NA
#1) Á¹?????? 2) Á¹???????? ?Ø´??Ç´? age?? ??À» ??Á®?Í¼? ??Ã¼



ave_age<-ave(teens$age, teens$gradyear, FUN=function(x) mean(x, na.rm=TRUE))

teens$age<-ifelse(is.na(teens$age),ave_age,teens$age) 

# ave(x, mygroup, FUN = mean)
# #2  2  2  7  7  7  7  7  7  7
# x       #1  2  3  4  5  6  7  8  9 10
# mygroup #1  1  1  2  2  2  2  2  2  2

summary(teens$age)

class(teens[5:40]) #3????, 36??

interests<-teens[5:40]

interests_z<-as.data.frame(lapply(interests, scale)) #Ç¥??È­(mu=0,sigma=1)

set.seed(12345)

teen_clusters<-kmeans(interests_z, 5)

teen_clusters$size #4161 21580   578  2663  1018

teen_clusters$centers #?? Å¬?????Í¿? ???? ?ß½?Á¡?? ??Ç¥(36????)
#ex) 1??Â° Å¬???????? ?ß½?Á¡:(0.0121330, 0.09171404, ..., -0.05735705)

# 1??:?îµ¿(????), ??È¸(Á¾??), À½??, ????, ?Ü¸? ???? ??À½
# 2??:?îµ¿ ?È¾???, ?? ?????? ??À½, ???????? ???Ìµ?...
# 3??:?îµ¿(????), ?Ü¸? ????, ??????
# 4??:?îµ¿ ?Å¿? ?Á¾???
# 5??:?îµ¿ Á¶?? ?Á¾???, ??Á¦??(À§??) ??À½, ??À» ???? ?Î¸?, ?Ü¸?, ???Â°? ?Á¾???

teens$cluster <- teen_clusters$cluster

teens[1:10,c("cluster", "gender", "age", "friends")]

aggregate(data=teens, age  ~ cluster, mean)
#Å¬?????? ??À§?? ???Ì¿? ???? ????À» ???Ø¶?

aggregate(data=teens, female  ~ cluster, mean)

aggregate(data=teens, friends  ~ cluster, mean)


#?Ð¼?Àº ???Â°?, ???Î¿? ?Ð»??? ????À» ?? -> snsdata -> cluster?


data<-as.data.frame(snsdata) #snsdata???? 36?? ?Ã·??? ???? ???? ?????? ????
data_z<-scale(data)


#dist
#cosine_sim

install.packages("proxy")
library(proxy)
#??????È£ : d1,d2,d3, c(?Ü¾?????È½?? ????)
#(sky, cloud, rain)
d1<-c(1,0,5)
d2<-c(4,7,3)
d3<-c(40,70,30)

doc<-rbind(d1,d2,d3) #????, row bind
colnames(doc)<-c("sky", "cloud", "rain")
doc

dist(doc, method="cosine") #?Ú»??? ?Å¸?

dist(doc, method="euclidean") #À¯Å¬?????? ?Å¸?































x<-1:10
x #???Ì°? 10?? ????

mean(x) #5.5
ave(x) #5.5 ... 5.5  (5.5???? ?????? ???Ì¸?Å­ ????)
#ave?Ô¼?: ?Ô·? ????(x)?? ???Ì¿? ?????? ?????? ???Í¸? ????

mygroup<-rep(1:2, c(3,7)) #1?? 3??, 2?? 7?? ?Ýº?
mygroup #?? ?×·?

ave(x, mygroup, FUN = mean)
        #2  2  2  7  7  7  7  7  7  7
x       #1  2  3  4  5  6  7  8  9 10
mygroup #1  1  1  2  2  2  2  2  2  2


ave(x, mygroup, FUN = sum)
#6  6  6 49 49 49 49 49 49 49
x       #1  2  3  4  5  6  7  8  9 10
mygroup #1  1  1  2  2  2  2  2  2  2














ave(x, mygroup, FUN = sum)

ave(x,mygroup,FUN=function(a)sum(a^2))






#1. ???À¹?Á¦
#gender?? ?Ù¸? ??À¸?? ??Ã¼, na ??À» ???? ?Ð»??? ???? À¯????(?Å¸?) ?Ð»? 10?? ?Ë»? -> ???? ?Ç´? = Å¬?????Í¸?
#2. ???? ?Û·????? Á¶Á¤(n-start ??)
#3. ?? Å¬?????? ?Ø¼?(using aggregate())
#???  ~ cluster  => ?Ø¼? ?????? ????À¸?? ?Û¼?
#4. wine ?????? Å¬?????Í¸?







